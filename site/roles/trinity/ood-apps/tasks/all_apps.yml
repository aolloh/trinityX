# ---
# - name: Configure ood apps on the controller
#   when: ansible_connection not in 'chroot'
#   block:

#     - name: Set correct permissions to app folders and create them if they don't exist
#       ansible.builtin.file:
#         path: /var/www/ood/apps/sys/{{ item.name }}
#         state: directory
#         mode: "{{ item.mode | default('0755') }}"
#         owner: "{{ item.owner | default('root') }}"
#         group: "{{ ood_apps_admin_group }}"
#         follow: true
#       notify: Run update_ood
#       with_items: "{{ ood_apps }}"

#     - name: Render custom manifests to create buttons in the menu
#       ansible.builtin.template:
#         src: "{{ item.name }}/manifest.yml.j2"
#         dest: /var/www/ood/apps/sys/{{ item.name }}/manifest.yml
#         owner: root
#         group: "{{ ood_apps_admin_group }}"
#         mode: "{{ item.mode | default('0644') }}"
#         backup: "yes"
#       notify: Run update_ood
#       with_items: "{{ ood_apps }}"
#       # when: "{{ lookup('ansible.builtin.file', 'templates/manifests/' + item.name + '.yml.j2', errors='ignore') }}"
#       # when: "'templates/manifests/' + item.name + '.yml.j2' is exists"
#       # register: ood_luna_apps_manifest
#       failed_when: false
    



