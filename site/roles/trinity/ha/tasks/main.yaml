---

- block:
  - name: Load a variable file based on the OS type, or a default if not found. Using free-form to specify the file.
    include_vars: "{{ item }}"
    with_first_found:
      - "{{ ansible_distribution }}{{ ansible_distribution_major_version}}.yaml"
      - "{{ ansible_os_family }}{{ ansible_distribution_major_version}}.yaml"
    ignore_errors: true

  - name: Install H/A packages
    yum:
      name: '{{ ha_packages }}'
      state: present
      enablerepo: ha

  # TODO: better way than below
  - name: Install PCS
    ansible.builtin.shell: |
      source /trinity/local/python/bin/activate
      pip3 install --upgrade {{ pcs_noarch_pip_repository }}/{{ pcs_pip }}
      exit $?
    args:
      executable: /bin/bash
    when: pcs_pip is defined

  # TODO: better way than below
  - name: Install PCS
    ansible.builtin.shell: |
      source /trinity/local/python/bin/activate
      pip3 install --upgrade -i {{ pcs_noarch_pip_repository }}/ pcs
      exit $?
    args:
      executable: /bin/bash
    when: pcs_pip is not defined
  when: ha | default(False)

#pcs_noarch_pip_repository
#pcs_pip

